<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Sprint6: Stack Overflow Search Engine: /home/coder/Code/CSE2341-18S-search-engine-Addison-Kimball-Jake-Watkins/Sprint6/MemoryMapped.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="FontenotMark2.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sprint6: Stack Overflow Search Engine
   </div>
   <div id="projectbrief">Search Engine for Stack Overflow Questions Implementing an Inverted File Index using an AVLTree or Hash Table</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">/home/coder/Code/CSE2341-18S-search-engine-Addison-Kimball-Jake-Watkins/Sprint6/MemoryMapped.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// //////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// MemoryMapped.h</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (c) 2013 Stephan Brumme. All rights reserved.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// see http://create.stephan-brumme.com/disclaimer.html</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// define fixed size integer types</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> __int64 uint64_t;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="class_memory_mapped.html">   21</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_memory_mapped.html">MemoryMapped</a></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3">   25</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3">CacheHint</a></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  {</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a9e6ba5bc1fd4a31f6df9a1a810edad6a">   27</a></span>&#160;    <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a9e6ba5bc1fd4a31f6df9a1a810edad6a">Normal</a>,         </div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3ac82ca352dd7171ad956c976f5d2c869b">   28</a></span>&#160;    <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3ac82ca352dd7171ad956c976f5d2c869b">SequentialScan</a>, </div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a890c837b823fa5e3cfe520678320c5e8">   29</a></span>&#160;    <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a890c837b823fa5e3cfe520678320c5e8">RandomAccess</a>    </div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  };</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951">   33</a></span>&#160;  <span class="keyword">enum</span> <a class="code" href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951">MapRange</a></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  {</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951aca0d43632991b4c7cfe183de4623b5df">   35</a></span>&#160;    <a class="code" href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951aca0d43632991b4c7cfe183de4623b5df">WholeFile</a> = 0   </div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  };</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="class_memory_mapped.html#a31e86d6c6131bb103a8eda5ef6992f7e">MemoryMapped</a>();</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="class_memory_mapped.html#a31e86d6c6131bb103a8eda5ef6992f7e">MemoryMapped</a>(<span class="keyword">const</span> std::string&amp; filename, <span class="keywordtype">size_t</span> mappedBytes = <a class="code" href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951aca0d43632991b4c7cfe183de4623b5df">WholeFile</a>, <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3">CacheHint</a> hint = <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a9e6ba5bc1fd4a31f6df9a1a810edad6a">Normal</a>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="class_memory_mapped.html#ae36f645dccdb40c4a5cabaa7092d036a">~MemoryMapped</a>();</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_memory_mapped.html#a1a0cc19f57e8befad88e614a3d163b20">open</a>(<span class="keyword">const</span> std::string&amp; filename, <span class="keywordtype">size_t</span> mappedBytes = <a class="code" href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951aca0d43632991b4c7cfe183de4623b5df">WholeFile</a>, <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3">CacheHint</a> hint = <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a9e6ba5bc1fd4a31f6df9a1a810edad6a">Normal</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_memory_mapped.html#a419ab4de6623978d95586bb7ed1dca18">close</a>();</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="class_memory_mapped.html#a55ea0d289456db74dad6537c2208da18">operator[]</a>(<span class="keywordtype">size_t</span> offset) <span class="keyword">const</span>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="class_memory_mapped.html#a6b8ecb4135982553a439b4355389a105">at</a>        (<span class="keywordtype">size_t</span> offset) <span class="keyword">const</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* <a class="code" href="class_memory_mapped.html#ab73b9191d4a3eb00627b707234d7262d">getData</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_memory_mapped.html#a756f8c5a9ca411e4b52e1402156f9dbf">isValid</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  uint64_t <a class="code" href="class_memory_mapped.html#ae77948a0dce20c918ce689284ead4ac8">size</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">size_t</span>   <a class="code" href="class_memory_mapped.html#a000576dd3ce3e0eba90169bf8fc59320">mappedSize</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_memory_mapped.html#a3283299f0db3e2243b67bfd24c45c882">remap</a>(uint64_t offset, <span class="keywordtype">size_t</span> mappedBytes);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="class_memory_mapped.html#a31e86d6c6131bb103a8eda5ef6992f7e">MemoryMapped</a>(<span class="keyword">const</span> <a class="code" href="class_memory_mapped.html">MemoryMapped</a>&amp;);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="class_memory_mapped.html">MemoryMapped</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="class_memory_mapped.html">MemoryMapped</a>&amp;);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> getpagesize();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  std::string _filename;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  uint64_t    _filesize;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3">CacheHint</a>   _hint;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">size_t</span>      _mappedBytes;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">typedef</span> <span class="keywordtype">void</span>* FileHandle;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">void</span>*       _mappedFile;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keyword">typedef</span> <span class="keywordtype">int</span>   FileHandle;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  FileHandle  _file;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">void</span>*       _mappedView;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;};</div><div class="ttc" id="class_memory_mapped_html_a4857c4797593ccdd4c20026d0b07dcc3a9e6ba5bc1fd4a31f6df9a1a810edad6a"><div class="ttname"><a href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a9e6ba5bc1fd4a31f6df9a1a810edad6a">MemoryMapped::Normal</a></div><div class="ttdoc">good overall performance </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:27</div></div>
<div class="ttc" id="class_memory_mapped_html_a4857c4797593ccdd4c20026d0b07dcc3a890c837b823fa5e3cfe520678320c5e8"><div class="ttname"><a href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3a890c837b823fa5e3cfe520678320c5e8">MemoryMapped::RandomAccess</a></div><div class="ttdoc">jump around </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:29</div></div>
<div class="ttc" id="class_memory_mapped_html"><div class="ttname"><a href="class_memory_mapped.html">MemoryMapped</a></div><div class="ttdoc">Portable read-only memory mapping (Windows and Linux) </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:21</div></div>
<div class="ttc" id="class_memory_mapped_html_a55ea0d289456db74dad6537c2208da18"><div class="ttname"><a href="class_memory_mapped.html#a55ea0d289456db74dad6537c2208da18">MemoryMapped::operator[]</a></div><div class="ttdeci">unsigned char operator[](size_t offset) const </div><div class="ttdoc">access position, no range checking (faster) </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:185</div></div>
<div class="ttc" id="class_memory_mapped_html_a4857c4797593ccdd4c20026d0b07dcc3ac82ca352dd7171ad956c976f5d2c869b"><div class="ttname"><a href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3ac82ca352dd7171ad956c976f5d2c869b">MemoryMapped::SequentialScan</a></div><div class="ttdoc">read file only once with few seeks </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:28</div></div>
<div class="ttc" id="class_memory_mapped_html_a570fe2733cf0f66c414b814fed767951"><div class="ttname"><a href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951">MemoryMapped::MapRange</a></div><div class="ttdeci">MapRange</div><div class="ttdoc">how much should be mapped </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:33</div></div>
<div class="ttc" id="class_memory_mapped_html_ae36f645dccdb40c4a5cabaa7092d036a"><div class="ttname"><a href="class_memory_mapped.html#ae36f645dccdb40c4a5cabaa7092d036a">MemoryMapped::~MemoryMapped</a></div><div class="ttdeci">~MemoryMapped()</div><div class="ttdoc">close file (see close() ) </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:67</div></div>
<div class="ttc" id="class_memory_mapped_html_a419ab4de6623978d95586bb7ed1dca18"><div class="ttname"><a href="class_memory_mapped.html#a419ab4de6623978d95586bb7ed1dca18">MemoryMapped::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">close file </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:148</div></div>
<div class="ttc" id="class_memory_mapped_html_ab73b9191d4a3eb00627b707234d7262d"><div class="ttname"><a href="class_memory_mapped.html#ab73b9191d4a3eb00627b707234d7262d">MemoryMapped::getData</a></div><div class="ttdeci">const unsigned char * getData() const </div><div class="ttdoc">raw access </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:205</div></div>
<div class="ttc" id="class_memory_mapped_html_a000576dd3ce3e0eba90169bf8fc59320"><div class="ttname"><a href="class_memory_mapped.html#a000576dd3ce3e0eba90169bf8fc59320">MemoryMapped::mappedSize</a></div><div class="ttdeci">size_t mappedSize() const </div><div class="ttdoc">get number of actually mapped bytes </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:226</div></div>
<div class="ttc" id="class_memory_mapped_html_ae77948a0dce20c918ce689284ead4ac8"><div class="ttname"><a href="class_memory_mapped.html#ae77948a0dce20c918ce689284ead4ac8">MemoryMapped::size</a></div><div class="ttdeci">uint64_t size() const </div><div class="ttdoc">get file size </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:219</div></div>
<div class="ttc" id="class_memory_mapped_html_a570fe2733cf0f66c414b814fed767951aca0d43632991b4c7cfe183de4623b5df"><div class="ttname"><a href="class_memory_mapped.html#a570fe2733cf0f66c414b814fed767951aca0d43632991b4c7cfe183de4623b5df">MemoryMapped::WholeFile</a></div><div class="ttdoc">everything ... be careful when file is larger than memory </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:35</div></div>
<div class="ttc" id="class_memory_mapped_html_a4857c4797593ccdd4c20026d0b07dcc3"><div class="ttname"><a href="class_memory_mapped.html#a4857c4797593ccdd4c20026d0b07dcc3">MemoryMapped::CacheHint</a></div><div class="ttdeci">CacheHint</div><div class="ttdoc">tweak performance </div><div class="ttdef"><b>Definition:</b> MemoryMapped.h:25</div></div>
<div class="ttc" id="class_memory_mapped_html_a756f8c5a9ca411e4b52e1402156f9dbf"><div class="ttname"><a href="class_memory_mapped.html#a756f8c5a9ca411e4b52e1402156f9dbf">MemoryMapped::isValid</a></div><div class="ttdeci">bool isValid() const </div><div class="ttdoc">true, if file successfully opened </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:212</div></div>
<div class="ttc" id="class_memory_mapped_html_a31e86d6c6131bb103a8eda5ef6992f7e"><div class="ttname"><a href="class_memory_mapped.html#a31e86d6c6131bb103a8eda5ef6992f7e">MemoryMapped::MemoryMapped</a></div><div class="ttdeci">MemoryMapped()</div><div class="ttdoc">do nothing, must use open() </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:36</div></div>
<div class="ttc" id="class_memory_mapped_html_a3283299f0db3e2243b67bfd24c45c882"><div class="ttname"><a href="class_memory_mapped.html#a3283299f0db3e2243b67bfd24c45c882">MemoryMapped::remap</a></div><div class="ttdeci">bool remap(uint64_t offset, size_t mappedBytes)</div><div class="ttdoc">replace mapping by a new one of the same file, offset MUST be a multiple of the page size ...</div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:233</div></div>
<div class="ttc" id="class_memory_mapped_html_a6b8ecb4135982553a439b4355389a105"><div class="ttname"><a href="class_memory_mapped.html#a6b8ecb4135982553a439b4355389a105">MemoryMapped::at</a></div><div class="ttdeci">unsigned char at(size_t offset) const </div><div class="ttdoc">access position, including range checking </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:192</div></div>
<div class="ttc" id="class_memory_mapped_html_a1a0cc19f57e8befad88e614a3d163b20"><div class="ttname"><a href="class_memory_mapped.html#a1a0cc19f57e8befad88e614a3d163b20">MemoryMapped::open</a></div><div class="ttdeci">bool open(const std::string &amp;filename, size_t mappedBytes=WholeFile, CacheHint hint=Normal)</div><div class="ttdoc">open file, mappedBytes = 0 maps the whole file </div><div class="ttdef"><b>Definition:</b> MemoryMapped.cpp:74</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
